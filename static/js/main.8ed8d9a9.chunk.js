(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){},13:function(e,t,n){e.exports={ticketWrapper:"Ticket_ticketWrapper__Tv5Xo",ticketTop:"Ticket_ticketTop__3LUGy",ticketPosition:"Ticket_ticketPosition__uk2J6",circle:"Ticket_circle__4AuXi",centerRight:"Ticket_centerRight__3juJM",centerLeft:"Ticket_centerLeft__1_FQH",ticketMainContent:"Ticket_ticketMainContent__1taxh",ticketMainContentTitle:"Ticket_ticketMainContentTitle__1lNLU",ticketContent:"Ticket_ticketContent__U8G0k",bottomRight:"Ticket_bottomRight__k_vgk",bottomLeft:"Ticket_bottomLeft__1s_az",ticketAction:"Ticket_ticketAction__vGhyd",iconWrapper:"Ticket_iconWrapper__3cQI_",dashed:"Ticket_dashed__V4Bvu"}},167:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(9),i=n.n(r),s=(n(127),n(128),n(33)),o=n(10),u=n(84),d=n.n(u),l=n(199),j=n(2);function b(){var e=Object(o.f)();return Object(j.jsx)("div",{className:d.a.pageWrapper,children:Object(j.jsxs)("div",{className:d.a.pageContent,children:[Object(j.jsx)("div",{className:"page-title",children:"Virtual Queue"}),Object(j.jsx)(l.a,{onClick:function(){e.push("/admin/create")},variant:"contained",className:"redBtn",children:"Create Queue"})]})})}var p=n(16),m=n(18),O=n.n(m),h=n(73),g=n(74),v=n(112),f=function(){function e(t){Object(h.a)(this,e),this.socket=Object(v.io)(t,{autoConnect:!1})}return Object(g.a)(e,[{key:"connect",value:function(e,t){var n=this;return this.socket.disconnect(),new Promise((function(a,c){n.socket.auth={qid:e,token:t},n.socket.on("connect",(function(){a(n.socket)})),n.socket.connect()}))}}]),e}(),x=Object(a.createContext)(),_=function(){function e(t){Object(h.a)(this,e),this.url=t}return Object(g.a)(e,[{key:"createSocket",value:function(){return new f(this.url)}},{key:"queueJoin",value:function(e,t,n){return fetch("".concat(this.url,"/queue/join"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({qid:e,name:t,message:n})})}},{key:"queueStatus",value:function(e){return fetch("".concat(this.url,"/queue/status?qid=").concat(e))}},{key:"queueAdminCreate",value:function(e,t){return fetch("".concat(this.url,"/queue/admin/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,qName:t})})}},{key:"queueAdminRemoveUser",value:function(e,t,n){return fetch("".concat(this.url,"/queue/admin/removeuser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e,token:t,qid:n})})}},{key:"queueAdminServeUser",value:function(e,t,n){return fetch("".concat(this.url,"/queue/admin/serveuser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e,token:t,qid:n})})}},{key:"queueAdminCompleteUser",value:function(e,t,n){return fetch("".concat(this.url,"/queue/admin/completeuser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e,token:t,qid:n})})}}]),e}(),k=n(205);function C(){var e=Object(a.useState)(""),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),i=Object(p.a)(r,2),s=i[0],u=i[1],d=Object(o.f)(),b=Object(a.useContext)(x);return Object(j.jsx)("div",{className:O.a.pageWrapper,children:Object(j.jsxs)("div",{className:O.a.pageContent,children:[Object(j.jsx)("div",{className:"page-title",children:"Create Room"}),Object(j.jsx)("div",{className:O.a.actionWrapper,children:Object(j.jsx)(k.a,{value:n,onChange:function(e){return c(e.target.value)},label:"Queue Name"})}),Object(j.jsx)("div",{className:O.a.actionWrapper,children:Object(j.jsx)(k.a,{value:s,onChange:function(e){return u(e.target.value)},label:"Your Name"})}),Object(j.jsx)("div",{className:O.a.actionWrapper,children:Object(j.jsx)(l.a,{onClick:function(){0!==n.length&&0!==s.length?b.queueAdminCreate(s,n).then((function(e){return e.json()})).then((function(e){window.localStorage.setItem("token",e.token),window.localStorage.setItem("uid",e.uid),d.push("/admin/dashboard/".concat(e.qid))})):alert("Both Queue Name and Name must be given")},variant:"contained",className:"redBtn",children:"Create Queue"})})]})})}var N=n(30),q=n.n(N),w=n(47),T=n(23),S=n(31),y=n.n(S),U=n(42),W=n.n(U),I=n(114),P=n.n(I),M=n(113),L=n.n(M),R=n(206),A=n(117);function B(e){var t=Object(a.useContext)(x),n=Object(o.g)().qid,c=window.localStorage.getItem("token"),r=Object(a.useState)(!1),i=Object(p.a)(r,2),s=i[0],u=i[1],d=Object(a.useRef)(null);return Object(j.jsxs)("div",{className:W.a.userCard,children:[Object(j.jsx)(A.a,{anchorEl:function(){return d.current},open:s,onClose:function(){return u(!1)},children:function(){if("serving"===e.type){return Object(j.jsx)(R.a,{onClick:function(){t.queueAdminCompleteUser(e.uid,c,n)},children:"Complete"})}return Object(j.jsx)(R.a,{onClick:function(){t.queueAdminRemoveUser(e.uid,c,n)},children:"Remove"})}()}),Object(j.jsx)("div",{className:W.a.cardUsername,children:e.name}),Object(j.jsx)("div",{className:W.a.cardMessage,children:e.message}),Object(j.jsxs)("div",{className:W.a.cardTime,children:[Object(j.jsx)("div",{children:e.time}),Object(j.jsx)(L.a,{})]}),Object(j.jsx)("div",{className:W.a.cardAction,children:Object(j.jsx)("div",{ref:d,onClick:function(){return u(!0)},className:W.a.optionsButton,children:Object(j.jsx)(P.a,{fontSize:"inherit"})})})]})}var D=n(58),Q=n(88),H=n.n(Q);function J(e){return Object(j.jsxs)("div",{className:H.a.widgetWrapper,children:[Object(j.jsx)("div",{className:H.a.widgetLink,children:e.link}),Object(j.jsx)(l.a,{variant:"contained",color:"primary",onClick:function(){window.navigator.clipboard.writeText(e.link),alert("Copied!")},children:"Copy"})]})}var z=n(203),V=n(207),E=n(204),G=Object(z.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function X(e){var t=G();return Object(j.jsx)(V.a,{className:t.backdrop,open:e.open,onClick:function(){},children:Object(j.jsx)(E.a,{})})}function Z(e){return Object(j.jsx)(D.c,{droppableId:e.dropId,children:function(t){return Object(j.jsxs)("div",Object(T.a)(Object(T.a)({className:y.a.userCardList},t.droppableProps),{},{ref:t.innerRef,children:[e.users.map((function(t,n){var a=e.queueData.users[t];return Object(j.jsx)(D.b,{draggableId:t.toString(),index:n,children:function(n){return Object(j.jsx)("div",Object(T.a)(Object(T.a)(Object(T.a)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{children:Object(j.jsx)(B,Object(T.a)(Object(T.a)(Object(T.a)({},n.draggableProps),n.dragHandleProps),{},{type:e.type,uid:t,name:a.name,time:a.joinTime,message:a.message}))}))}},t)})),t.placeholder]}))}})}function F(){var e=Object(o.g)().qid,t=window.localStorage.getItem("token"),n=Object(a.useContext)(x),c=Object(a.useRef)(n.createSocket()),r=Object(a.useState)(),i=Object(p.a)(r,2),s=i[0],u=i[1],d=Object(o.f)(),l=function(e){e.on("queue:update",(function(e){u(e)}))},b=Object(a.useRef)(Object(w.a)(q.a.mark((function a(){var r,i,s;return q.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.queueStatus(e);case 2:if(400!==(r=a.sent).status){a.next=7;break}return alert("Invalid qid"),d.push("/"),a.abrupt("return");case 7:return a.next=9,r.json();case 9:return i=a.sent,u(i),a.next=13,c.current.connect(e,t);case 13:s=a.sent,l(s);case 15:case"end":return a.stop()}}),a)}))));if(Object(a.useEffect)((function(){b.current()}),[b]),void 0===s)return Object(j.jsx)(X,{open:!0});var m=function(e,t,n){return 0===e.length?Object(j.jsx)(D.c,{droppableId:t,children:function(e){return Object(j.jsx)("div",Object(T.a)(Object(T.a)({className:y.a.emptyUsers},e.droppableProps),{},{ref:e.innerRef,children:e.placeholder}))}}):Object(j.jsx)(Z,{type:n,dropId:t,users:e,queueData:s})};return Object(j.jsx)(D.a,{onDragEnd:function(t){if("queueUsers"===t.source.droppableId&&"servingUsers"===t.destination.droppableId){var a=window.localStorage.getItem("token");n.queueAdminServeUser(parseInt(t.draggableId),a,e).then((function(e){200!==e.status&&e.json().then((function(e){return alert(e.message)}))}))}},children:Object(j.jsxs)("div",{className:y.a.pageWrapper,children:[Object(j.jsx)("div",{className:y.a.sideBar,children:"Virtual Queue"}),Object(j.jsxs)("div",{className:y.a.main,children:[Object(j.jsx)("div",{className:"page-title",children:"Dashboard"}),Object(j.jsx)(J,{link:"".concat(window.location.origin,"/virtual-queue/#/queue/").concat(e)}),Object(j.jsx)("div",{className:y.a.queueTitle,children:s.queue.name}),Object(j.jsx)("div",{className:y.a.stateTitle,children:"Serving"}),m(s.queue.serving,"servingUsers","serving"),Object(j.jsx)("div",{className:y.a.stateTitle,children:"Queue"}),m(s.queue.queue,"queueUsers","queue")]})]})})}function K(e){var t=Object(a.useState)(""),n=Object(p.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(""),s=Object(p.a)(i,2),u=s[0],d=s[1],b=Object(o.g)().qid,m=Object(a.useContext)(x);return Object(j.jsx)("div",{className:O.a.pageWrapper,children:Object(j.jsxs)("div",{className:O.a.pageContent,children:[Object(j.jsx)("div",{className:O.a.pageTitle,children:e.queueName}),Object(j.jsx)("div",{className:O.a.actionWrapper,children:Object(j.jsx)(k.a,{value:c,onChange:function(e){return r(e.target.value)},label:"Name"})}),Object(j.jsx)("div",{className:O.a.actionWrapper,children:Object(j.jsx)(k.a,{value:u,multiline:!0,rows:8,onChange:function(e){return d(e.target.value)},label:"Your Message"})}),Object(j.jsx)("div",{className:O.a.actionWrapper,children:Object(j.jsx)(l.a,{onClick:function(){0!==c.length?0!==u.length?(e.setLoading(!0),function(){var t=Object(w.a)(q.a.mark((function t(n,a){var c,r;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.queueJoin(b,n,a);case 2:if(400!==(c=t.sent).status){t.next=6;break}return alert("Invalid qid"),t.abrupt("return");case 6:return t.next=8,c.json();case 8:return r=t.sent,window.localStorage.setItem("token",r.token),console.log(r),window.localStorage.setItem("uid",r.uid),e.setToken(r.token),e.setUid(r.uid),t.abrupt("return");case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(c,u)):alert("Message cannot be empty"):alert("Name cannot be empty")},variant:"contained",color:"secondary",children:"Join"})})]})})}var Y=n(57),$=n.n(Y),ee=n(13),te=n.n(ee),ne=n(115),ae=n.n(ne),ce=n(116),re=n.n(ce);function ie(e){return Object(j.jsxs)("div",{className:te.a.ticketWrapper,children:[Object(j.jsxs)("div",{className:te.a.ticketTop,children:[Object(j.jsx)("div",{className:"".concat(te.a.circle," ").concat(te.a.centerLeft)}),Object(j.jsx)("div",{className:"".concat(te.a.circle," ").concat(te.a.centerRight)}),Object(j.jsx)("div",{className:te.a.ticketPosition,children:e.bannerMessage})]}),Object(j.jsxs)("div",{className:te.a.ticketContent,children:[Object(j.jsx)("div",{className:"".concat(te.a.circle," ").concat(te.a.bottomLeft)}),Object(j.jsx)("div",{className:"".concat(te.a.circle," ").concat(te.a.bottomRight)}),Object(j.jsxs)("div",{className:te.a.ticketMainContent,children:[Object(j.jsx)("div",{className:te.a.ticketMainContentTitle,children:"Message"}),e.message]}),Object(j.jsx)("hr",{className:te.a.dashed})]}),Object(j.jsxs)("div",{className:te.a.ticketAction,children:[Object(j.jsx)(l.a,{variant:"contained",className:"yellowBtn",children:Object(j.jsx)("div",{className:te.a.iconWrapper,children:Object(j.jsx)(ae.a,{fontSize:"inherit"})})}),Object(j.jsx)(l.a,{variant:"contained",className:"redBtn",children:Object(j.jsx)("div",{className:te.a.iconWrapper,children:Object(j.jsx)(re.a,{fontSize:"inherit"})})})]})]})}function se(){var e=Object(a.useState)(window.localStorage.getItem("token")),t=Object(p.a)(e,2),n=t[0],r=t[1],i=window.localStorage.getItem("uid");null!=i&&(i=parseInt(i));var s=Object(o.f)(),u=Object(a.useState)(i),d=Object(p.a)(u,2),l=d[0],b=d[1],m=Object(o.g)().qid,O=Object(a.useContext)(x),h=Object(a.useState)(!1),g=Object(p.a)(h,2),v=g[0],f=g[1],_=Object(a.useState)(),k=Object(p.a)(_,2),C=k[0],N=k[1],T=Object(a.useState)(!1),S=Object(p.a)(T,2),y=S[0],U=S[1],W=Object(a.useRef)(O.createSocket()),I=Object(a.useRef)(Object(w.a)(q.a.mark((function e(){var t,n;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.queueStatus(m);case 2:if(400!==(t=e.sent).status){e.next=6;break}return alert("Invalid qid"),e.abrupt("return");case 6:return e.next=8,t.json();case 8:n=e.sent,N(n);case 10:case"end":return e.stop()}}),e)}))));Object(a.useEffect)((function(){I.current()}),[I]);if(Object(a.useEffect)((function(){console.log("Token is ".concat(n)),null!==n&&W.current.connect(m,n).then((function(e){return function(e){e.on("queue:update",(function(e){N(e),U(!0),console.log("Connected")})),e.on("queue:complete",(function(e){console.log("received complete"),s.push("/"),window.localStorage.removeItem("token"),window.localStorage.removeItem("uid")})),e.on("queue:remove",(function(e){console.log("received complete"),s.push("/"),window.localStorage.removeItem("token"),window.localStorage.removeItem("uid")}))}(e)}))}),[n,m]),void 0===C)return Object(j.jsx)(X,{open:!0});if(null===n||null===l||void 0===l)return Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsx)(X,{open:v}),Object(j.jsx)(K,{queueName:C.queue.name,loading:v,setLoading:f,setToken:r,setUid:b})]});if(!(l in C.users))return console.log(void 0===l),console.log(l),console.log(C),y?(alert("Invalid Uid"),window.localStorage.removeItem("uid"),window.localStorage.removeItem("token"),r(null),null):(I.current(),Object(j.jsx)(X,{open:!0}));return Object(j.jsxs)("div",{className:$.a.pageWrapper,children:[Object(j.jsx)("div",{className:$.a.pageTitle,children:C.queue.name}),Object(j.jsx)("div",{className:$.a.pageDialogText,children:"Hi ".concat(C.users[l].name,", your position is:")}),Object(j.jsx)("div",{className:$.a.pageContent,children:function(){console.log(C);var e=C.users[l].message;if(C.queue.queue.includes(l)){return Object(j.jsx)(ie,{bannerMessage:function(e){var t=e.toString();switch(t.charAt(t.length-1)){case"1":return t+"st";case"2":return t+"nd";case"3":return t+"rd";default:return t+"th"}}(C.queue.queue.indexOf(l)+1),message:e})}if(C.queue.serving.includes(l))return Object(j.jsx)(ie,{bannerMessage:"Currently Serving",message:e})}()})]})}var oe=function(){var e=new _("https://virtualqueuebackend.herokuapp.com");return Object(j.jsx)(x.Provider,{value:e,children:Object(j.jsx)(s.a,{children:Object(j.jsxs)(o.c,{children:[Object(j.jsx)(o.a,{path:"/queue/:qid",children:Object(j.jsx)(se,{})}),Object(j.jsx)(o.a,{path:"/admin/dashboard/:qid",children:Object(j.jsx)(F,{})}),Object(j.jsx)(o.a,{path:"/admin/create",children:Object(j.jsx)(C,{})}),Object(j.jsx)(o.a,{path:"/",children:Object(j.jsx)(b,{})})]})})})};i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(oe,{})}),document.getElementById("root"))},18:function(e,t,n){e.exports={pageTitle:"CreateQueuePage_pageTitle__1MHwh",pageWrapper:"CreateQueuePage_pageWrapper__2bzLU",pageContent:"CreateQueuePage_pageContent__BeunA",actionWrapper:"CreateQueuePage_actionWrapper__22van"}},31:function(e,t,n){e.exports={pageWrapper:"Dashboard_pageWrapper__15-rO",sideBar:"Dashboard_sideBar__3HUet",main:"Dashboard_main__1PS_-",queueTitle:"Dashboard_queueTitle__1p-x6",stateTitle:"Dashboard_stateTitle__ii7um",emptyUsers:"Dashboard_emptyUsers__DS6QW",userCardList:"Dashboard_userCardList__ZKdHc"}},42:function(e,t,n){e.exports={userCard:"UserCard_userCard__16ZMZ",cardUsername:"UserCard_cardUsername__2m1Wv",cardMessage:"UserCard_cardMessage__z4IOO",cardAction:"UserCard_cardAction__1N-st",cardTime:"UserCard_cardTime__wvKqQ",iconButton:"UserCard_iconButton__3VV3c",optionsButton:"UserCard_optionsButton__3zlPs UserCard_iconButton__3VV3c"}},57:function(e,t,n){e.exports={pageWrapper:"UserPage_pageWrapper__1-1qO",pageContent:"UserPage_pageContent__2kvVg",pageTitle:"UserPage_pageTitle__1H0lg",pageDialogText:"UserPage_pageDialogText__3HlXy"}},84:function(e,t,n){e.exports={pageWrapper:"HomePage_pageWrapper__HxgDM",pageContent:"HomePage_pageContent__1H03w"}},88:function(e,t,n){e.exports={widgetWrapper:"LinkWidget_widgetWrapper__3x4te",widgetLink:"LinkWidget_widgetLink__1fuJm"}}},[[167,1,2]]]);
//# sourceMappingURL=main.8ed8d9a9.chunk.js.map